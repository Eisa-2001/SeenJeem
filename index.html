<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Ø³ÙŠÙ† Ø¬ÙŠÙ… - Ù†Ø³Ø®Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© (Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø±)</title>
  <style>
    :root{
      --bg:#f5f6f8;
      --card:#ffffff;
      --ink:#111827;
      --muted:#6b7280;
      --brand:#ff7a3d;
      --brand2:#ff5b2e;
      --line:#e5e7eb;
      --good:#16a34a;
      --bad:#dc2626;
      --shadow: 0 12px 35px rgba(0,0,0,.08);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Kufi Arabic", "Noto Sans Arabic", Arial, sans-serif;
      background: var(--bg);
      color: var(--ink);
    }
    a{color:inherit}
    .app{
      max-width:1200px;
      margin:0 auto;
      padding:16px;
      padding-bottom:84px;
    }

    /* Topbar */
    .topbar{
      position: sticky;
      top:0;
      z-index: 10;
      background: linear-gradient(90deg, var(--brand2), var(--brand));
      color:#fff;
      border-radius: 16px;
      padding:12px 14px;
      box-shadow: var(--shadow);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .topbar .left, .topbar .right{display:flex; align-items:center; gap:10px}
    .pill{
      background: rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.25);
      color:#fff;
      padding:8px 10px;
      border-radius: 999px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
      font-weight:700;
      font-size:13px;
    }
    .btn{
      border:0;
      border-radius: 999px;
      padding:10px 12px;
      background: rgba(255,255,255,.18);
      color:#fff;
      font-weight:800;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      border:1px solid rgba(255,255,255,.25);
    }
    .btn:active{transform: translateY(1px)}
    .btn.secondary{
      background:#fff;
      color: var(--ink);
      border:1px solid #fff;
    }

    /* Sections */
    .section{
      margin-top:14px;
      background: var(--card);
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:14px;
      box-shadow: 0 8px 25px rgba(0,0,0,.05);
    }
    .section h2{
      margin:0 0 10px 0;
      font-size:18px;
    }
    .muted{color:var(--muted); font-size:13px}

    /* Settings */
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width:900px){
      .grid2{grid-template-columns:1fr}
    }
    .field{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .field label{
      font-weight:800;
      font-size:13px;
      color: var(--muted);
    }
    input[type="text"], input[type="number"], textarea, select{
      width:100%;
      border:1px solid var(--line);
      border-radius: 14px;
      padding:10px 12px;
      font-size:15px;
      outline:none;
      background:#fff;
    }
    textarea{min-height:90px; resize:vertical}
    .row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    .chip{
      border:1px solid var(--line);
      background:#fff;
      border-radius:999px;
      padding:8px 10px;
      font-weight:800;
      font-size:12px;
      color: var(--muted);
    }

    /* Board */
    .boardHeader{
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:12px;
      flex-wrap:wrap;
    }
    .teams{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .teamCard{
      background: #fff;
      border:1px solid var(--line);
      border-radius: 16px;
      padding:10px 12px;
      min-width:220px;
      box-shadow: 0 8px 22px rgba(0,0,0,.05);
    }
    .teamName{
      font-weight:900;
      font-size:14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .score{
      font-size:26px;
      font-weight:1000;
      margin-top:6px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .score .miniBtns{
      display:flex;
      gap:6px;
    }
    .mini{
      border:1px solid var(--line);
      background:#fff;
      border-radius: 999px;
      padding:6px 10px;
      font-weight:1000;
      cursor:pointer;
    }

    .catGrid{
      margin-top:14px;
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      gap:10px;
    }
    @media (max-width:1100px){ .catGrid{grid-template-columns: repeat(4, 1fr);} }
    @media (max-width:850px){ .catGrid{grid-template-columns: repeat(3, 1fr);} }
    @media (max-width:600px){ .catGrid{grid-template-columns: repeat(2, 1fr);} }

    .catCard{
      border-radius: 18px;
      border:1px solid var(--line);
      background: linear-gradient(180deg,#fefefe,#fafafa);
      box-shadow: 0 10px 24px rgba(0,0,0,.05);
      overflow:hidden;
      position:relative;
      cursor:pointer;
    }
    .catCard:hover{outline:2px solid rgba(255,122,61,.25)}
    .catThumb{
      height:110px;
      background:#eef2ff;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .catThumb img{
      width:100%;
      height:100%;
      object-fit:cover;
    }
    .catTitle{
      padding:10px;
      font-weight:1000;
      text-align:center;
      background: var(--brand);
      color:#fff;
      font-size:14px;
    }
    .badge{
      position:absolute;
      top:8px;
      left:8px;
      background: rgba(17,24,39,.85);
      color:#fff;
      padding:6px 8px;
      border-radius: 999px;
      font-weight:900;
      font-size:12px;
    }

    /* Value board */
    .valueBoard{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
    }
    .valueBtn{
      border-radius: 18px;
      border:1px solid var(--line);
      background:#fff;
      padding:16px;
      text-align:center;
      font-weight:1000;
      font-size:22px;
      cursor:pointer;
      box-shadow: 0 10px 20px rgba(0,0,0,.05);
    }
    .valueBtn.disabled{
      opacity:.45;
      cursor:not-allowed;
      text-decoration: line-through;
    }
    .valueHint{
      font-size:12px;
      color: var(--muted);
      margin-top:6px;
      font-weight:800;
    }

    /* Modal */
    .overlay{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.55);
      z-index:100;
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
    }
    .modal{
      width:min(920px, 100%);
      background:#fff;
      border-radius: 22px;
      box-shadow: 0 24px 80px rgba(0,0,0,.25);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.15);
    }
    .modalTop{
      background: linear-gradient(90deg, var(--brand2), var(--brand));
      color:#fff;
      padding:12px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .modalTop .title{
      font-weight:1000;
      font-size:14px;
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .modalBody{
      padding:16px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:12px;
    }
    @media (max-width:900px){
      .modalBody{grid-template-columns:1fr}
    }
    .qBox{
      border:1px solid var(--line);
      border-radius: 18px;
      padding:14px;
      background: #fbfbfb;
    }
    .qText{
      font-size:22px;
      font-weight:1000;
      line-height:1.35;
      margin:0 0 10px 0;
    }
    .imgWrap{
      border-radius: 16px;
      overflow:hidden;
      border:1px solid var(--line);
      background:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      max-height:360px;
    }
    .imgWrap img{
      width:100%;
      height:100%;
      object-fit:contain;
      max-height:360px;
    }

    .answerBox{
      border:1px solid var(--line);
      border-radius: 18px;
      padding:14px;
      background:#fff;
      display:flex;
      flex-direction:column;
      gap:10px;
      min-height:200px;
    }
    .reveal{
      border:1px dashed var(--line);
      border-radius: 16px;
      padding:12px;
      background:#fafafa;
    }
    .reveal .ans{
      font-size:20px;
      font-weight:1000;
      margin-top:6px;
    }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:6px;
    }
    .actionBtn{
      border:0;
      border-radius: 14px;
      padding:12px 14px;
      font-weight:1000;
      cursor:pointer;
      flex:1;
      min-width: 160px;
    }
    .actionBtn.good{background: #e9f7ee; color: var(--good); border:1px solid #b7ebc8;}
    .actionBtn.bad{background: #fdecec; color: var(--bad); border:1px solid #f5b5b5;}
    .actionBtn.neutral{background: #f3f4f6; color: #111827; border:1px solid #e5e7eb;}

    .teamPick{
      display:none;
      margin-top:10px;
      padding-top:10px;
      border-top:1px solid var(--line);
    }
    .teamPick h3{
      margin:0 0 8px 0;
      font-size:14px;
    }
    .teamBtns{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .teamBtn{
      flex:1;
      min-width:160px;
      border:1px solid var(--line);
      background:#fff;
      border-radius: 14px;
      padding:12px 14px;
      font-weight:1000;
      cursor:pointer;
    }
    .teamBtn:hover{outline:2px solid rgba(255,122,61,.25)}

    /* Bottom bar */
    .bottomBar{
      position: fixed;
      bottom: 12px;
      left: 0;
      right: 0;
      display:flex;
      justify-content:center;
      z-index: 9;
      pointer-events:none;
    }
    .bottomInner{
      pointer-events:auto;
      max-width:1200px;
      width: calc(100% - 24px);
      background: rgba(255,255,255,.92);
      backdrop-filter: blur(10px);
      border:1px solid var(--line);
      border-radius: 999px;
      padding:10px;
      box-shadow: var(--shadow);
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .bbtn{
      border:0;
      border-radius: 999px;
      padding:10px 12px;
      font-weight:1000;
      cursor:pointer;
      background: var(--brand);
      color:#fff;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .bbtn.gray{
      background:#111827;
    }
    .bbtn.light{
      background:#fff;
      color:#111827;
      border:1px solid var(--line);
    }
    .smallNote{font-size:12px; color:var(--muted); font-weight:800}

    .hidden{display:none !important;}
  </style>
</head>

<body>
  <div class="app">

    <div class="topbar">
      <div class="left">
        <div class="pill">ğŸ® Ø³ÙŠÙ† Ø¬ÙŠÙ… (Ù†Ø³Ø®Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø±)</div>
        <div class="pill" id="gameStatus">Ø¬Ø§Ù‡Ø²</div>
      </div>
      <div class="right">
        <button class="btn" id="btnGoSettings">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
        <button class="btn secondary" id="btnNewGame">ğŸ”„ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
      </div>
    </div>

    <!-- SETTINGS -->
    <div class="section" id="settingsSection">
      <h2>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
      <div class="muted">
        - ØªÙ‚Ø¯Ø± ØªØºÙŠÙ‘Ø± Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙØ±Ù‚ Ù‡Ù†Ø§.<br/>
        - ØªÙ‚Ø¯Ø± ØªØ³ØªÙˆØ±Ø¯ Ø¨Ù†Ùƒ Ø£Ø³Ø¦Ù„Ø© (JSON) ÙˆØªØ¶ÙŠÙ Ø¹Ù„ÙŠÙ‡ Ø¢Ù„Ø§Ù Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¨Ø¯ÙˆÙ† Ù…Ø§ ÙŠÙ†Ø®Ø±Ø¨ Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆÙ„Ø§ ÙŠØ±Ø¬Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø¯Ø§Ø®Ù„ Ù†ÙØ³ Ø§Ù„Ù„Ø¹Ø¨Ø©.
      </div>

      <div style="height:10px"></div>

      <div class="grid2">
        <div class="field">
          <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</label>
          <input type="text" id="teamAName" value="T" />
        </div>
        <div class="field">
          <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</label>
          <input type="text" id="teamBName" value="R" />
        </div>

        <div class="field">
          <label>Ù…Ø¯Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ (Ø«ÙˆØ§Ù†ÙŠ)</label>
          <input type="number" id="qTime" min="5" max="180" value="60" />
          <div class="muted">Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø¹Ø¯Ù„Ù‡ Ø£Ùˆ Ø®Ù„Ù‡ 60.</div>
        </div>

        <div class="field">
          <label>Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØµØ¹ÙˆØ¨Ø© (Ø«Ø§Ø¨ØªØ© Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„)</label>
          <div class="row">
            <span class="chip">200 = Ù…ØªÙˆØ³Ø·</span>
            <span class="chip">400 = ØµØ¹Ø¨</span>
            <span class="chip">600 = Ø´Ø¨Ù‡ Ù…Ø³ØªØ­ÙŠÙ„</span>
          </div>
          <div class="muted">Ù„Ùˆ Ø³Ø¤Ø§Ù„ 600 Ø·Ù„Ø¹ Ø³Ù‡Ù„: Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ù…Ù† Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©ØŒ Ù…Ùˆ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù….</div>
        </div>
      </div>

      <div style="height:12px"></div>

      <div class="section" style="margin-top:12px">
        <h2>Ø¥Ø¯Ø§Ø±Ø© Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h2>
        <div class="muted">
          - <b>Ø§Ø³ØªÙŠØ±Ø§Ø¯</b> ÙŠØ¶ÙŠÙ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ (Merge).<br/>
          - <b>Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</b> ÙŠØ­Ø°Ù Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© â€œÙ…Ø§ÙÙŠ Ø®ÙŠØ§Ø± Ù…Ø³Ø­â€).<br/>
          - <b>ØªØµØ¯ÙŠØ±</b> ÙŠØ¹Ø·ÙŠÙƒ JSON Ø¬Ø§Ù‡Ø² ØªØ­ÙØ¸Ù‡.
        </div>

        <div style="height:10px"></div>

        <div class="grid2">
          <div class="field">
            <label>Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON</label>
            <textarea id="importBox" placeholder='Ø§Ù„ØµÙ‚ JSON Ù‡Ù†Ø§...'></textarea>
            <div class="row">
              <button class="bbtn light" id="btnImport">â¬†ï¸ Ø§Ø³ØªÙŠØ±Ø§Ø¯ + Ø¯Ù…Ø¬</button>
              <button class="bbtn light" id="btnReplace">ğŸ§¨ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ÙƒØ§Ù…Ù„</button>
            </div>
            <div class="muted">
              <b>Ù…Ù‡Ù…:</b> Ø¥Ø°Ø§ ØªØ¨ÙŠ ØªÙ…Ø³Ø­ Ø§Ù„Ù‚Ø¯ÙŠÙ… ÙˆØªØ¨Ø¯Ø£ Ù…Ù† Ø§Ù„ØµÙØ± Ø§Ø³ØªØ®Ø¯Ù… â€œØ§Ø³ØªØ¨Ø¯Ø§Ù„ ÙƒØ§Ù…Ù„â€.
            </div>
          </div>

          <div class="field">
            <label>ØªØµØ¯ÙŠØ± / Ù…Ø³Ø­</label>
            <textarea id="exportBox" readonly></textarea>
            <div class="row">
              <button class="bbtn light" id="btnExport">â¬‡ï¸ ØªØµØ¯ÙŠØ± JSON</button>
              <button class="bbtn gray" id="btnClearAll">ğŸ—‘ï¸ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</button>
            </div>
            <div class="muted" id="bankStats">...</div>
          </div>
        </div>
      </div>

      <div style="height:12px"></div>
      <div class="row">
        <button class="bbtn" id="btnSaveSettings">âœ… Ø­ÙØ¸ ÙˆØ¨Ø¯Ø¡</button>
        <span class="smallNote">Ø¨Ø¹Ø¯ Ø§Ù„Ø­ÙØ¸ Ø¨ØªØ±ÙˆØ­ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© ÙˆØ§Ù„Ù†ØªÙŠØ¬Ø© Ø¨ØªÙƒÙˆÙ† Ø¸Ø§Ù‡Ø±Ø©.</span>
      </div>
    </div>

    <!-- GAME / BOARD -->
    <div class="section hidden" id="gameSection">
      <div class="boardHeader">
        <div>
          <h2 style="margin:0">Ù„ÙˆØ­Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©</h2>
          <div class="muted">Ø§Ø®ØªÙØ± ØªØµÙ†ÙŠÙ â†’ Ø§Ø®ØªÙØ± 200 / 400 / 600 â†’ Ø¬Ø§ÙˆØ¨.</div>
        </div>

        <div class="teams">
          <div class="teamCard">
            <div class="teamName">
              <span id="teamANameShow">T</span>
              <span class="chip">ÙØ±ÙŠÙ‚</span>
            </div>
            <div class="score">
              <span id="teamAScore">0</span>
              <div class="miniBtns">
                <button class="mini" id="teamAPlus">+100</button>
                <button class="mini" id="teamAMinus">-100</button>
              </div>
            </div>
          </div>

          <div class="teamCard">
            <div class="teamName">
              <span id="teamBNameShow">R</span>
              <span class="chip">ÙØ±ÙŠÙ‚</span>
            </div>
            <div class="score">
              <span id="teamBScore">0</span>
              <div class="miniBtns">
                <button class="mini" id="teamBPlus">+100</button>
                <button class="mini" id="teamBMinus">-100</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div style="height:12px"></div>

      <div class="section" style="margin-top:0">
        <div class="row" style="justify-content:space-between">
          <div class="row" style="gap:8px">
            <span class="chip" id="catCountChip">ØªØµÙ†ÙŠÙØ§Øª: --</span>
            <span class="chip" id="qCountChip">Ø£Ø³Ø¦Ù„Ø©: --</span>
            <span class="chip" id="usedChip">Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©: 0</span>
          </div>
          <div class="row" style="gap:8px">
            <button class="bbtn light" id="btnResetUsed">â™»ï¸ ØªØµÙÙŠØ± Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± (Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø© ÙÙ‚Ø·)</button>
          </div>
        </div>
      </div>

      <div class="section">
        <h2 style="margin:0 0 10px 0">Ø§Ø®ØªØ± ØªØµÙ†ÙŠÙ</h2>
        <div class="catGrid" id="catGrid"></div>
      </div>

      <div class="section hidden" id="valuesSection">
        <h2 style="margin:0 0 6px 0">Ø§Ø®ØªØ± Ø§Ù„Ù†Ù‚Ø§Ø·</h2>
        <div class="muted" id="selectedCatHint"></div>
        <div class="valueBoard" id="valueBoard"></div>
      </div>
    </div>

  </div>

  <!-- Modal -->
  <div class="overlay" id="overlay">
    <div class="modal">
      <div class="modalTop">
        <div class="title">
          <span id="mCat">â€”</span>
          <span class="pill" id="mPoints">â€”</span>
          <span class="pill" id="mTimer">â±ï¸ 60</span>
        </div>
        <button class="btn" id="btnClose">âœ–ï¸ Ø¥ØºÙ„Ø§Ù‚</button>
      </div>

      <div class="modalBody">
        <div class="qBox">
          <p class="qText" id="mQ">â€”</p>
          <div class="imgWrap hidden" id="mImgWrap">
            <img id="mImg" alt="ØµÙˆØ±Ø© Ø§Ù„Ø³Ø¤Ø§Ù„" />
          </div>
          <div class="muted" id="mNote" style="margin-top:10px"></div>
        </div>

        <div class="answerBox">
          <div class="reveal">
            <div class="muted">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</div>
            <div class="ans" id="mA">â€¢â€¢â€¢â€¢â€¢</div>
          </div>

          <div class="actions">
            <button class="actionBtn neutral" id="btnReveal">ğŸ‘ï¸ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</button>
            <button class="actionBtn good" id="btnCorrect">âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©</button>
            <button class="actionBtn bad" id="btnWrong">âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©</button>
          </div>

          <div class="teamPick" id="teamPick">
            <h3>Ø§Ø®ØªØ± Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù„ÙŠ ÙŠØ§Ø®Ø° Ø§Ù„Ù†Ù‚Ø§Ø·</h3>
            <div class="teamBtns">
              <button class="teamBtn" id="pickA">â€”</button>
              <button class="teamBtn" id="pickB">â€”</button>
            </div>
            <div class="muted" style="margin-top:8px">
              Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± ÙŠØ·Ù„Ø¹ <b>Ø¨Ø¹Ø¯</b> Ù…Ø§ ØªØ¶ØºØ· â€œØ¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©â€ Ù…Ø«Ù„ Ù…Ø§ Ø·Ù„Ø¨Øª.
            </div>
          </div>

          <button class="actionBtn neutral" id="btnNext" style="margin-top:8px">â¡ï¸ Ø¥ØºÙ„Ø§Ù‚ ÙˆØ§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø©</button>
        </div>
      </div>
    </div>
  </div>

  <div class="bottomBar">
    <div class="bottomInner">
      <div class="smallNote" id="footerNote">Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© + ØµØ¹ÙˆØ¨Ø© Ù…ÙˆØ­Ù‘Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„</div>
      <div class="row">
        <button class="bbtn light" id="btnScrollTop">â¬†ï¸ Ø£Ø¹Ù„Ù‰</button>
        <button class="bbtn" id="btnBackToBoard">ğŸ Ø§Ù„Ù„ÙˆØ­Ø©</button>
      </div>
    </div>
  </div>

<script>
/* =========================
   1) Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (Starter)
   - ÙƒÙ„ Ø³Ø¤Ø§Ù„ Ù„Ø§Ø²Ù… Ù„Ù‡ id ÙØ±ÙŠØ¯
   - type: "text" Ø£Ùˆ "image"
   - q: Ø§Ù„Ø³Ø¤Ø§Ù„
   - a: Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© (Ù‚ØµÙŠØ±Ø© ÙˆÙ…Ø¨Ø§Ø´Ø±Ø©)
   - img: Ø±Ø§Ø¨Ø·/Ø¨ÙŠØ³64 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
   - difficulty: 200/400/600
   ========================= */

const START_BANK = {
  meta: {
    version: "final-studio-engine-1",
    note: "Ù‡Ø°Ø§ Ø¨Ù†Ùƒ Ù…Ø¨Ø¯Ø¦ÙŠ. Ø¶ÙŠÙ Ø¹Ù„ÙŠÙ‡ Ø¹Ø¨Ø± Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¹Ø´Ø§Ù† ØªÙˆØµÙ„ 800+ Ø³Ø¤Ø§Ù„ Ø¨Ø³Ù‡ÙˆÙ„Ø©."
  },
  categories: [
    // Ø£ÙÙ„Ø§Ù… (Ù…Ø³ØªÙˆÙ‰ Ù…Ø¶Ø¨ÙˆØ·)
    {
      id: "movies",
      title: "Ø£ÙÙ„Ø§Ù…",
      thumb: null,
      questions: [
        {id:"mv-200-1", difficulty:200, q:"Ù…Ù† Ø£Ø®Ø±Ø¬ ÙÙŠÙ„Ù… InceptionØŸ", a:"ÙƒØ±ÙŠØ³ØªÙˆÙØ± Ù†ÙˆÙ„Ø§Ù†"},
        {id:"mv-200-2", difficulty:200, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø¨Ø·Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙÙŠ ÙÙŠÙ„Ù… John WickØŸ", a:"Ø¬ÙˆÙ† ÙˆÙŠÙƒ"},
        {id:"mv-200-3", difficulty:200, q:"ÙÙŠ Ø£ÙŠ Ù…Ø¯ÙŠÙ†Ø© ØªØ¯ÙˆØ± Ø£ØºÙ„Ø¨ Ø£Ø­Ø¯Ø§Ø« ÙÙŠÙ„Ù… The Dark KnightØŸ", a:"ØºÙˆØ«Ø§Ù…"},
        {id:"mv-400-1", difficulty:400, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø³ÙÙŠÙ†Ø© ÙÙŠ ÙÙŠÙ„Ù… TitanicØŸ", a:"ØªØ§ÙŠØªØ§Ù†ÙŠÙƒ"},
        {id:"mv-400-2", difficulty:400, q:"Ù…Ù† Ø£Ø®Ø±Ø¬ ÙÙŠÙ„Ù… The GodfatherØŸ", a:"ÙØ±Ø§Ù†Ø³ÙŠØ³ ÙÙˆØ±Ø¯ ÙƒÙˆØ¨ÙˆÙ„Ø§"},
        {id:"mv-400-3", difficulty:400, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„ÙƒÙˆÙƒØ¨ ÙÙŠ ÙÙŠÙ„Ù… Avatar (2009)ØŸ", a:"Ø¨Ø§Ù†Ø¯ÙˆØ±Ø§"},
        {id:"mv-600-1", difficulty:600, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø®ÙŠØ§Ù„ÙŠØ© ÙÙŠ ÙÙŠÙ„Ù… Blade RunnerØŸ", a:"Ù„ÙˆØ³ Ø£Ù†Ø¬Ù„ÙØ³ (Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©)"},
        {id:"mv-600-2", difficulty:600, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø³Ù„Ø§Ø­/Ø§Ù„Ø£Ø¯Ø§Ø© Ø§Ù„ØªÙŠ ÙŠØ³ØªØ®Ø¯Ù…Ù‡Ø§ Ø±Ø¬Ø§Ù„ Men in Black Ù„Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø©ØŸ", a:"Neuralyzer"},
        {id:"mv-600-3", difficulty:600, q:"ÙÙŠ ÙÙŠÙ„Ù… InterstellarØŒ Ù…Ø§ Ø§Ø³Ù… Ù…Ø±ÙƒØ¨Ø© Ø§Ù„Ø¥Ù†Ù‚Ø§Ø°/Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©ØŸ", a:"Endurance"}
      ]
    },

    // Ù…Ø³Ù„Ø³Ù„Ø§Øª
    {
      id: "series",
      title: "Ù…Ø³Ù„Ø³Ù„Ø§Øª",
      thumb: null,
      questions: [
        {id:"sr-200-1", difficulty:200, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ù„Ø³Ù„ Ø§Ù„Ø°ÙŠ Ø¨Ø·Ù„Ù‡ ÙˆØ§Ù„ØªØ± ÙˆØ§ÙŠØªØŸ", a:"Breaking Bad"},
        {id:"sr-200-2", difficulty:200, q:"ÙÙŠ Ù…Ø³Ù„Ø³Ù„ FriendsØŒ ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠÙŠÙ†ØŸ", a:"6"},
        {id:"sr-200-3", difficulty:200, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ù„Ø³Ù„ Ø§Ù„Ø°ÙŠ ØªØ¯ÙˆØ± Ø£Ø­Ø¯Ø§Ø«Ù‡ ÙÙŠ Ù‡ÙˆÙƒÙŠÙ†Ø² ÙˆÙÙŠÙ‡ Ø¹Ø§Ù„Ù… Ù…Ù‚Ù„ÙˆØ¨ØŸ", a:"Stranger Things"},
        {id:"sr-400-1", difficulty:400, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙŠ Ù…Ø³Ù„Ø³Ù„ The SopranosØŸ", a:"Ø¹Ø§Ø¦Ù„Ø© Ø³ÙˆØ¨Ø±Ø§Ù†Ùˆ"},
        {id:"sr-400-2", difficulty:400, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ù…Ù‚Ù‡Ù‰ Ø§Ù„Ø´Ù‡ÙŠØ± ÙÙŠ Ù…Ø³Ù„Ø³Ù„ FriendsØŸ", a:"Central Perk"},
        {id:"sr-400-3", difficulty:400, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙŠ Ù…Ø³Ù„Ø³Ù„ Peaky BlindersØŸ", a:"ØªÙˆÙ…ÙŠ Ø´ÙŠÙ„Ø¨ÙŠ"},
        {id:"sr-600-1", difficulty:600, q:"ÙÙŠ Ù…Ø³Ù„Ø³Ù„ DarkØŒ Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø¨Ù„Ø¯Ø© Ø§Ù„ØªÙŠ ØªØ¬Ø±ÙŠ ÙÙŠÙ‡Ø§ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«ØŸ", a:"ÙˆÙŠÙ†Ø¯Ù†"},
        {id:"sr-600-2", difficulty:600, q:"ÙÙŠ Ù…Ø³Ù„Ø³Ù„ Better Call SaulØŒ Ù…Ø§ Ø§Ø³Ù… Ø§Ø³Ù… 'Ø³ÙˆÙ„' Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŸ", a:"Ø¬ÙŠÙ…ÙŠ Ù…Ø§ÙƒØºÙŠÙ„"},
        {id:"sr-600-3", difficulty:600, q:"ÙÙŠ Ù…Ø³Ù„Ø³Ù„ The Office (US)ØŒ Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©ØŸ", a:"Dunder Mifflin"}
      ]
    },

    // Ø£Ù„Ø¹Ø§Ø¨ (Ø£Ø³Ø¦Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù† Ù„Ø¹Ø¨Ø© Ù…Ø­Ø¯Ø¯Ø©)
    {
      id: "games",
      title: "Ø£Ù„Ø¹Ø§Ø¨",
      thumb: null,
      questions: [
        {id:"gm-200-1", difficulty:200, q:"Ù…Ù† Ù‡Ùˆ Ø¨Ø·Ù„ Ù„Ø¹Ø¨Ø© God of War (Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„Ø­Ø¯ÙŠØ«Ø©)ØŸ", a:"ÙƒØ±ÙŠØªÙˆØ³"},
        {id:"gm-200-2", difficulty:200, q:"Ù…Ø§ Ø§Ø³Ù… Ù…Ø¯ÙŠÙ†Ø© Ù„Ø¹Ø¨Ø© GTA: San Andreas Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©ØŸ", a:"Ù„ÙˆØ³ Ø³Ø§Ù†ØªÙˆØ³"},
        {id:"gm-200-3", difficulty:200, q:"ÙÙŠ MinecraftØŒ Ù…Ø§ Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ø¦Ù† Ø§Ù„Ø£Ø®Ø¶Ø± Ø§Ù„Ø°ÙŠ ÙŠÙ†ÙØ¬Ø±ØŸ", a:"Creeper"},
        {id:"gm-400-1", difficulty:400, q:"Ù…Ø§ Ø§Ø³Ù… Ø´Ø±ÙƒØ© ØªØ·ÙˆÙŠØ± Ø³Ù„Ø³Ù„Ø© The Legend of ZeldaØŸ", a:"Nintendo"},
        {id:"gm-400-2", difficulty:400, q:"ÙÙŠ Assassin's Creed (Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙˆÙ„)ØŒ Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø¨Ø·Ù„ØŸ", a:"Ø£Ù„ØªØ§ÙŠØ±"},
        {id:"gm-400-3", difficulty:400, q:"Ù…Ø§ Ø§Ø³Ù… Ù…Ù†Ø¸Ù…Ø© Ø§Ù„Ø£Ø´Ø±Ø§Ø± ÙÙŠ Resident Evil Ø§Ù„ØªÙŠ ØªØªÙƒØ±Ø± ÙƒØ«ÙŠØ±Ù‹Ø§ØŸ", a:"Umbrella"},
        {id:"gm-600-1", difficulty:600, q:"ÙÙŠ BloodborneØŒ Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„ØªÙŠ ØªØ¯ÙˆØ± ÙÙŠÙ‡Ø§ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«ØŸ", a:"Yharnam"},
        {id:"gm-600-2", difficulty:600, q:"ÙÙŠ Elden RingØŒ Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø·Ù‚Ø©/Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø°ÙŠ ØªØ¬Ø±ÙŠ ÙÙŠÙ‡ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«ØŸ", a:"The Lands Between"},
        {id:"gm-600-3", difficulty:600, q:"ÙÙŠ Metal Gear SolidØŒ Ù…Ø§ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ù…Ø²ÙŠ Ù„Ù„Ø¨Ø·Ù„ØŸ", a:"Solid Snake"}
      ]
    },

    // Ø£Ù†Ù…ÙŠ (Ù…Ø¨Ø§Ø´Ø± + ØµØ¹ÙˆØ¨Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©)
    {
      id: "anime",
      title: "Ø£Ù†Ù…ÙŠ",
      thumb: null,
      questions: [
        {id:"an-200-1", difficulty:200, q:"Ù…Ù† Ù‡Ùˆ Ø¨Ø·Ù„ NarutoØŸ", a:"Ù†Ø§Ø±ÙˆØªÙˆ Ø£ÙˆØ²ÙˆÙ…Ø§ÙƒÙŠ"},
        {id:"an-200-2", difficulty:200, q:"Ù…Ø§ Ø§Ø³Ù… Ø·Ø§Ù‚Ù… Ù„ÙˆÙÙŠ ÙÙŠ One PieceØŸ", a:"Ù‚Ø¨Ø¹Ø© Ø§Ù„Ù‚Ø´"},
        {id:"an-200-3", difficulty:200, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø³ÙŠÙ Ø§Ù„Ø¹Ù…Ù„Ø§Ù‚ Ø§Ù„Ø°ÙŠ ÙŠØ­Ù…Ù„Ù‡ Ø¥ÙŠØªØ´ÙŠØºÙˆ ÙÙŠ BleachØŸ", a:"Ø²Ø§Ù†ØºÙŠØªØ³Ùˆ"},
        {id:"an-400-1", difficulty:400, q:"ÙÙŠ Attack on TitanØŒ Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯Ø§Ø± Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØŸ", a:"Ù…Ø§Ø±ÙŠØ§"},
        {id:"an-400-2", difficulty:400, q:"ÙÙŠ Demon SlayerØŒ Ù…Ø§ Ø§Ø³Ù… ØªÙ†ÙÙ‘Ø³ ØªØ§Ù†Ø¬ÙŠØ±Ùˆ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØŸ", a:"ØªÙ†ÙÙ‘Ø³ Ø§Ù„Ù…Ø§Ø¡"},
        {id:"an-400-3", difficulty:400, q:"ÙÙŠ NarutoØŒ Ù…Ø§ Ø§Ø³Ù… ÙØ±ÙŠÙ‚ ÙƒØ§ÙƒØ§Ø´ÙŠØŸ", a:"Ø§Ù„ÙØ±ÙŠÙ‚ 7"},
        {id:"an-600-1", difficulty:600, q:"ÙÙŠ One PieceØŒ Ù…Ø§ Ø§Ø³Ù… Ø¬Ø²ÙŠØ±Ø© Ø§Ù„Ø·Ø§Ù‚Ù… Ø¨Ø¹Ø¯ ØªØ§ÙŠÙ… Ø³ÙƒÙŠØ¨ Ù„ØªØ¬Ù…Ø¹Ù‡Ù…ØŸ", a:"Ø´Ø§Ø¨ÙˆÙ†Ø¯ÙŠ"},
        {id:"an-600-2", difficulty:600, q:"ÙÙŠ Attack on TitanØŒ Ù…Ø§ Ø§Ø³Ù… Ø§Ù„ÙØµÙŠÙ„ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…Ø¬Ù†Ø¯ÙŠÙ†ØŸ", a:"ÙÙŠÙ„Ù‚ Ø§Ù„ØªØ¯Ø±ÙŠØ¨"},
        {id:"an-600-3", difficulty:600, q:"ÙÙŠ BleachØŒ Ù…Ø§ Ø§Ø³Ù… Ù…Ù†Ø¸Ù…Ø© Ø§Ù„ÙƒÙˆÙŠÙ†Ø³ÙŠ Ø§Ù„ØªÙŠ ÙŠÙ‚ÙˆØ¯Ù‡Ø§ ÙŠÙˆÙ‡Ø§Ø¨Ø§Ø®ØŸ", a:"Wandenreich"}
      ]
    },

    // ÙƒØ±Ø© Ù‚Ø¯Ù… (ØªØ¬Ù†Ø¨ Ø§Ù„Ø³Ù‡Ù„ Ø¬Ø¯Ù‹Ø§ØŒ ÙˆØ®Ù„ÙŠ 600 Ù…Ø³ØªØ­ÙŠÙ„ ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§)
    {
      id: "football",
      title: "ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…",
      thumb: null,
      questions: [
        {id:"fb-200-1", difficulty:200, q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù„Ø¹Ø¨ Ù„ÙƒÙ„ ÙØ±ÙŠÙ‚ ÙÙŠ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…ØŸ", a:"11"},
        {id:"fb-200-2", difficulty:200, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠØ© Ù„Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ø£Ø´Ù‡Ø±ØŸ", a:"Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§"},
        {id:"fb-200-3", difficulty:200, q:"ÙƒÙ… Ù…Ø¯Ø© Ø§Ù„Ø´ÙˆØ· Ø§Ù„ÙˆØ§Ø­Ø¯ (Ø¨Ø¯ÙˆÙ† ÙˆÙ‚Øª Ø¨Ø¯Ù„ Ø¶Ø§Ø¦Ø¹)ØŸ", a:"45 Ø¯Ù‚ÙŠÙ‚Ø©"},
        {id:"fb-400-1", difficulty:400, q:"Ø£ÙŠ Ù…Ù†ØªØ®Ø¨ ÙØ§Ø² Ø¨ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù… 2014ØŸ", a:"Ø£Ù„Ù…Ø§Ù†ÙŠØ§"},
        {id:"fb-400-2", difficulty:400, q:"Ù…Ù† Ø£ÙƒØ«Ø± Ù„Ø§Ø¹Ø¨ ÙØ§Ø² Ø¨Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© Ø­ØªÙ‰ 2023ØŸ", a:"Ù„ÙŠÙˆÙ†ÙŠÙ„ Ù…ÙŠØ³ÙŠ"},
        {id:"fb-400-3", difficulty:400, q:"Ù…Ø§ Ø§Ø³Ù… Ù…Ù„Ø¹Ø¨ Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠØŸ", a:"Ø³Ø§Ù†ØªÙŠØ§ØºÙˆ Ø¨Ø±Ù†Ø§Ø¨ÙŠÙˆ"},
        {id:"fb-600-1", difficulty:600, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø­ÙƒÙ… Ø§Ù„Ø°ÙŠ Ø£Ø¯Ø§Ø± Ù†Ù‡Ø§Ø¦ÙŠ ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù… 2010ØŸ", a:"Ù‡ÙˆØ§Ø±Ø¯ ÙˆÙŠØ¨"},
        {id:"fb-600-2", difficulty:600, q:"Ù…Ù† Ù‡Ø¯Ø§Ù ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù… 2002ØŸ", a:"Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ"},
        {id:"fb-600-3", difficulty:600, q:"Ø£ÙŠ Ù…Ù†ØªØ®Ø¨ ÙØ§Ø² Ø¨ÙƒØ£Ø³ Ø¢Ø³ÙŠØ§ 2019ØŸ", a:"Ù‚Ø·Ø±"}
      ]
    },

    // Ø¯ÙˆÙ„ ÙˆØ¹ÙˆØ§ØµÙ…
    {
      id:"geo",
      title:"Ø¯ÙˆÙ„ ÙˆØ¹ÙˆØ§ØµÙ…",
      thumb:null,
      questions:[
        {id:"ge-200-1", difficulty:200, q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªØŸ", a:"Ø£Ø¨ÙˆØ¸Ø¨ÙŠ"},
        {id:"ge-200-2", difficulty:200, q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ØŸ", a:"Ø·ÙˆÙƒÙŠÙˆ"},
        {id:"ge-200-3", difficulty:200, q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© ÙØ±Ù†Ø³Ø§ØŸ", a:"Ø¨Ø§Ø±ÙŠØ³"},
        {id:"ge-400-1", difficulty:400, q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© ÙƒØ§Ø²Ø§Ø®Ø³ØªØ§Ù†ØŸ", a:"Ø£Ø³ØªØ§Ù†Ø§"},
        {id:"ge-400-2", difficulty:400, q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© ÙƒÙ†Ø¯Ø§ØŸ", a:"Ø£ÙˆØªØ§ÙˆØ§"},
        {id:"ge-400-3", difficulty:400, q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© Ø£Ø³ØªØ±Ø§Ù„ÙŠØ§ØŸ", a:"ÙƒØ§Ù†Ø¨Ø±Ø§"},
        {id:"ge-600-1", difficulty:600, q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© Ø³Ø±ÙŠÙ„Ø§Ù†ÙƒØ§ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©ØŸ", a:"Ø³Ø±ÙŠ Ø¬Ø§ÙŠØ§ÙˆØ§Ø±Ø¯Ù†Ø§Ø¨ÙˆØ±Ø§ ÙƒÙˆØªÙŠ"},
        {id:"ge-600-2", difficulty:600, q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© Ø¨ÙˆÙ„ÙŠÙÙŠØ§ Ø§Ù„Ø¯Ø³ØªÙˆØ±ÙŠØ©ØŸ", a:"Ø³ÙˆÙƒØ±ÙŠ"},
        {id:"ge-600-3", difficulty:600, q:"Ù…Ø§ Ø¹Ø§ØµÙ…Ø© Ø¬Ù†ÙˆØ¨ Ø£ÙØ±ÙŠÙ‚ÙŠØ§ (Ø§Ù„ØªØ´Ø±ÙŠØ¹ÙŠØ©)ØŸ", a:"ÙƒÙŠØ¨ ØªØ§ÙˆÙ†"}
      ]
    },

    // Ù„ØºØ© ÙˆØ£Ø¯Ø¨ (Ø­Ø³Ø¨ Ø·Ù„Ø¨Ùƒ "ØªØµÙ†ÙŠÙ Ø£Ø¯Ø¨")
    {
      id:"adab",
      title:"Ù„ØºØ© ÙˆØ£Ø¯Ø¨",
      thumb:null,
      questions:[
        {id:"ad-200-1", difficulty:200, q:"Ù…Ø§ Ø§Ø³Ù… Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ±Ù‚ÙŠÙ… (ØŸ)ØŸ", a:"Ø¹Ù„Ø§Ù…Ø© Ø§Ø³ØªÙÙ‡Ø§Ù…"},
        {id:"ad-200-2", difficulty:200, q:"Ù…Ø±Ø§Ø¯Ù ÙƒÙ„Ù…Ø© â€œÙØµÙŠØ­â€ØŸ", a:"Ø¨Ù„ÙŠØº"},
        {id:"ad-200-3", difficulty:200, q:"Ù…Ø§ Ø¬Ù…Ø¹ ÙƒÙ„Ù…Ø© â€œÙ‚ØµÙŠØ¯Ø©â€ØŸ", a:"Ù‚ØµØ§Ø¦Ø¯"},
        {id:"ad-400-1", difficulty:400, q:"Ù…Ù† Ù‡Ùˆ ØµØ§Ø­Ø¨ Ù…Ø¹Ù„Ù‚Ø© â€œÙ‚ÙØ§ Ù†Ø¨ÙƒÙ Ù…Ù† Ø°ÙƒØ±Ù‰ Ø­Ø¨ÙŠØ¨ ÙˆÙ…Ù†Ø²Ù„Ùâ€ØŸ", a:"Ø§Ù…Ø±Ø¤ Ø§Ù„Ù‚ÙŠØ³"},
        {id:"ad-400-2", difficulty:400, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø´Ø¹Ø±ÙŠ ÙÙŠ: â€œØ¥Ø°Ø§ Ø§Ù„Ø´Ø¹Ø¨Ù ÙŠÙˆÙ…Ù‹Ø§ Ø£Ø±Ø§Ø¯ Ø§Ù„Ø­ÙŠØ§Ø©â€ØŸ", a:"Ø§Ù„Ø®ÙÙŠÙ"},
        {id:"ad-400-3", difficulty:400, q:"Ù…Ø§ Ù…Ø¹Ù†Ù‰ â€œØ³ÙØ¬ÙÙ„Ù‘â€ ÙÙŠ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµÙŠØ­Ø©ØŸ", a:"ÙƒØªØ§Ø¨/ÙˆØ«ÙŠÙ‚Ø©"},
        {id:"ad-600-1", difficulty:600, q:"Ù…Ù† Ù‡Ùˆ Ù…Ø¤Ù„Ù ÙƒØªØ§Ø¨ â€œØ¯Ù„Ø§Ø¦Ù„ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø²â€ØŸ", a:"Ø¹Ø¨Ø¯ Ø§Ù„Ù‚Ø§Ù‡Ø± Ø§Ù„Ø¬Ø±Ø¬Ø§Ù†ÙŠ"},
        {id:"ad-600-2", difficulty:600, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø£Ø¯Ø¨ÙŠØ© Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø±Ù…Ø²ÙŠØ© ÙÙŠ Ø§Ù„Ø´Ø¹Ø± Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ø­Ø¯ÙŠØ«ØŸ", a:"Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¯ÙŠÙˆØ§Ù†/Ø£Ø¨ÙˆÙ„Ù‘Ùˆ (Ø­Ø³Ø¨ Ø§Ù„Ø³ÙŠØ§Ù‚)"},
        {id:"ad-600-3", difficulty:600, q:"Ù…Ø§ Ø§Ø³Ù… Ø§Ù„Ø´Ø§Ø¹Ø± Ø§Ù„Ø°ÙŠ Ù„ÙÙ‚Ù‘Ø¨ Ø¨Ù€â€œØ´Ø§Ø¹Ø± Ø§Ù„Ù†ÙŠÙ„â€ØŸ", a:"Ø­Ø§ÙØ¸ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…"}
      ]
    }
  ]
};


/* =========================
   2) Ù…Ø­Ø±Ùƒ Ø§Ù„Ù„Ø¹Ø¨Ø©
   ========================= */
const $ = (sel) => document.querySelector(sel);

let BANK = null;                 // Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ
let usedInGame = new Set();      // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© (Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³Ø¤Ø§Ù„)
let chosenCatId = null;
let chosenValue = null;
let currentQ = null;
let timer = null;
let timeLeft = 0;

let teamA = { name: "T", score: 0 };
let teamB = { name: "R", score: 0 };

function deepClone(obj){ return JSON.parse(JSON.stringify(obj)); }

function normalizeBank(raw){
  // ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ø´ÙƒÙ„ + Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø£Ø³Ø¦Ù„Ø© Ù†Ø§Ù‚ØµØ© + Ø¶Ù…Ø§Ù† id ÙØ±ÙŠØ¯ Ù‚Ø¯Ø± Ø§Ù„Ø¥Ù…ÙƒØ§Ù†
  const b = deepClone(raw);

  if(!b || !Array.isArray(b.categories)) throw new Error("JSON ØºÙŠØ± ØµØ­ÙŠØ­: Ù„Ø§Ø²Ù… categories[]");

  const seen = new Set();
  for(const cat of b.categories){
    if(!cat.id) cat.id = "cat_" + Math.random().toString(16).slice(2);
    if(!cat.title) cat.title = "ØªØµÙ†ÙŠÙ";
    if(!Array.isArray(cat.questions)) cat.questions = [];

    const cleaned = [];
    for(const q of cat.questions){
      if(!q || !q.q || !q.a || !q.difficulty) continue;
      const dif = Number(q.difficulty);
      if(![200,400,600].includes(dif)) continue;

      let id = q.id || `${cat.id}-${dif}-${Math.random().toString(16).slice(2)}`;
      // Ù„Ùˆ ØªÙƒØ±Ø± id ÙÙŠ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ØŒ Ù†ØºÙŠÙ‘Ø±Ù‡
      while(seen.has(id)) id = id + "_" + Math.random().toString(16).slice(2);
      seen.add(id);

      cleaned.push({
        id,
        difficulty: dif,
        q: String(q.q).trim(),
        a: String(q.a).trim(),
        img: q.img ? String(q.img).trim() : null,
        note: q.note ? String(q.note).trim() : null
      });
    }
    cat.questions = cleaned;
  }
  return b;
}

function loadInitial(){
  BANK = normalizeBank(START_BANK);
}

function bankStats(){
  const cats = BANK.categories.length;
  let qs = 0;
  for(const c of BANK.categories) qs += c.questions.length;
  return {cats, qs};
}

function setStatus(txt){
  $("#gameStatus").textContent = txt;
}

function saveSettingsAndStart(){
  teamA.name = ($("#teamAName").value || "T").trim();
  teamB.name = ($("#teamBName").value || "R").trim();
  $("#teamANameShow").textContent = teamA.name;
  $("#teamBNameShow").textContent = teamB.name;
  $("#pickA").textContent = teamA.name;
  $("#pickB").textContent = teamB.name;

  // reset scores only at "Ø¨Ø¯Ø¡"
  teamA.score = 0; teamB.score = 0;
  $("#teamAScore").textContent = teamA.score;
  $("#teamBScore").textContent = teamB.score;

  usedInGame.clear();
  updateUsedChip();

  $("#settingsSection").classList.add("hidden");
  $("#gameSection").classList.remove("hidden");
  setStatus("Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©");
  renderCategories();
  $("#valuesSection").classList.add("hidden");
}

function updateUsedChip(){
  $("#usedChip").textContent = `Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©: ${usedInGame.size}`;
}

function renderCategories(){
  const grid = $("#catGrid");
  grid.innerHTML = "";

  // counts
  const st = bankStats();
  $("#catCountChip").textContent = `ØªØµÙ†ÙŠÙØ§Øª: ${st.cats}`;
  $("#qCountChip").textContent = `Ø£Ø³Ø¦Ù„Ø©: ${st.qs}`;
  $("#bankStats").textContent = `Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª: ${st.cats} | Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©: ${st.qs} | Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©: ${usedInGame.size}`;

  // sort categories by title
  const cats = [...BANK.categories].sort((a,b)=> a.title.localeCompare(b.title,'ar'));

  for(const cat of cats){
    const remaining = countRemainingForCat(cat.id);

    const card = document.createElement("div");
    card.className = "catCard";
    card.dataset.id = cat.id;

    const thumb = document.createElement("div");
    thumb.className = "catThumb";

    if(cat.thumb){
      const img = document.createElement("img");
      img.src = cat.thumb;
      img.alt = cat.title;
      thumb.appendChild(img);
    } else {
      // placeholder Ø¨Ø³ÙŠØ·
      thumb.style.background = "linear-gradient(135deg, #e0f2fe, #fff7ed)";
      thumb.innerHTML = `<div style="font-weight:1000;color:#111827;font-size:28px">ğŸ¯</div>`;
    }

    const title = document.createElement("div");
    title.className = "catTitle";
    title.textContent = cat.title;

    const badge = document.createElement("div");
    badge.className = "badge";
    badge.textContent = `Ø¨Ø§Ù‚ÙŠ ${remaining} Ø³Ø¤Ø§Ù„`;

    card.appendChild(thumb);
    card.appendChild(title);
    card.appendChild(badge);

    card.addEventListener("click", ()=> selectCategory(cat.id));

    grid.appendChild(card);
  }
}

function countRemainingForCat(catId){
  const cat = BANK.categories.find(c=>c.id===catId);
  if(!cat) return 0;
  let rem = 0;
  for(const q of cat.questions){
    if(!usedInGame.has(q.id)) rem++;
  }
  return rem;
}

function selectCategory(catId){
  chosenCatId = catId;
  const cat = BANK.categories.find(c=>c.id===catId);
  $("#valuesSection").classList.remove("hidden");
  $("#selectedCatHint").textContent = `Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø®ØªØ§Ø±: ${cat.title} â€” Ø§Ø®ØªØ± Ø§Ù„Ù†Ù‚Ø§Ø· (Ø§Ù„ØµØ¹ÙˆØ¨Ø© ØªØªØ¨Ø¹ Ø§Ù„Ù†Ù‚Ø§Ø·).`;

  // build value buttons with availability
  const values = [200,400,600];
  const vb = $("#valueBoard");
  vb.innerHTML = "";
  for(const v of values){
    const btn = document.createElement("div");
    btn.className = "valueBtn";
    const remaining = countRemainingForCatAndValue(catId, v);

    btn.innerHTML = `
      <div>${v}</div>
      <div class="valueHint">${difficultyLabel(v)} | Ø¨Ø§Ù‚ÙŠ: ${remaining}</div>
    `;

    if(remaining <= 0){
      btn.classList.add("disabled");
    } else {
      btn.addEventListener("click", ()=> openQuestion(catId, v));
    }

    vb.appendChild(btn);
  }

  // scroll to values
  $("#valuesSection").scrollIntoView({behavior:"smooth", block:"start"});
}

function countRemainingForCatAndValue(catId, value){
  const cat = BANK.categories.find(c=>c.id===catId);
  if(!cat) return 0;
  return cat.questions.filter(q=>q.difficulty===value && !usedInGame.has(q.id)).length;
}

function difficultyLabel(v){
  if(v===200) return "Ù…ØªÙˆØ³Ø·";
  if(v===400) return "ØµØ¹Ø¨";
  return "Ø´Ø¨Ù‡ Ù…Ø³ØªØ­ÙŠÙ„";
}

function pickQuestionNoRepeat(catId, value){
  const cat = BANK.categories.find(c=>c.id===catId);
  if(!cat) return null;

  // ÙÙ„ØªØ±Ø© Ù„Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©
  const pool = cat.questions.filter(q => q.difficulty===value && !usedInGame.has(q.id));
  if(pool.length === 0) return null;

  // Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ
  const idx = Math.floor(Math.random() * pool.length);
  return pool[idx];
}

// ÙÙ„ØªØ± Ø¨Ø³ÙŠØ· ÙŠÙ…Ù†Ø¹ â€œØ§Ù„Ø¬ÙˆØ§Ø¨â€ ÙŠÙƒÙˆÙ† Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ (Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø£Ø³Ø¦Ù„Ø©/ØµÙˆØ± Ù…Ø«Ù„ Ø´Ø¹Ø§Ø± ÙÙŠÙ‡ Ø§Ù„Ø§Ø³Ù…)
// Ù…Ù„Ø§Ø­Ø¸Ø©: Ù…Ø§ ÙŠÙ‚Ø¯Ø± ÙŠÙƒØ´Ù Ø§Ù„Ù†Øµ Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙˆØ±ØŒ Ù„ÙƒÙ† ÙŠÙ…Ù†Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø³Ø¤Ø§Ù„ ÙÙŠÙ‡ Ø§Ø³Ù… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©.
function isBadQuestion(q){
  const qText = (q.q || "").toLowerCase();
  const ans = (q.a || "").toLowerCase();

  if(!qText || !ans) return true;
  // Ø¥Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø£Ø·ÙˆÙ„ Ù…Ù† 2 Ø£Ø­Ø±Ù ÙˆØ·Ù„Ø¹Øª Ø­Ø±ÙÙŠÙ‹Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ â†’ Ù†Ø¹ØªØ¨Ø±Ù‡ Ø³ÙŠØ¡
  if(ans.length >= 3 && qText.includes(ans)) return true;

  return false;
}

function openQuestion(catId, value){
  chosenValue = value;
  const cat = BANK.categories.find(c=>c.id===catId);

  // Ù†Ø¬ÙŠØ¨ Ø³Ø¤Ø§Ù„ØŒ ÙˆÙ„Ùˆ ÙƒØ§Ù† â€œØ³ÙŠØ¡â€ Ù†Ø¹ÙŠØ¯ Ù…Ø­Ø§ÙˆÙ„Ø© 10 Ù…Ø±Ø§Øª Ø¹Ø´Ø§Ù† Ù†Ù„Ø§Ù‚ÙŠ ÙˆØ§Ø­Ø¯ Ù…Ù†Ø§Ø³Ø¨
  let q = null;
  for(let i=0;i<10;i++){
    const candidate = pickQuestionNoRepeat(catId, value);
    if(!candidate) break;
    if(!isBadQuestion(candidate)){
      q = candidate;
      break;
    } else {
      // Ù†Ø¹ØªØ¨Ø±Ù‡ â€œÙ…Ø­Ø±ÙˆÙ‚â€ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ø´Ø§Ù† Ù…Ø§ ÙŠØ±Ø¬Ø¹ ÙŠØ·Ù„Ø¹ ÙˆÙŠØ³Ø¨Ø¨ Ø§Ø²Ø¹Ø§Ø¬
      usedInGame.add(candidate.id);
    }
  }
  if(!q) q = pickQuestionNoRepeat(catId, value);

  if(!q){
    alert("Ø®Ù„ØµØª Ø£Ø³Ø¦Ù„Ø© Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ/Ø§Ù„Ù†Ù‚Ø§Ø· Ø¯Ø§Ø®Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ù„Ø¹Ø¨Ø©.");
    renderCategories();
    selectCategory(catId);
    return;
  }

  currentQ = q;
  usedInGame.add(q.id);
  updateUsedChip();
  renderCategories();
  selectCategory(catId);

  // Modal fill
  $("#mCat").textContent = cat.title;
  $("#mPoints").textContent = `${value} Ù†Ù‚Ø·Ø© â€” ${difficultyLabel(value)}`;
  $("#mQ").textContent = q.q;

  $("#mA").textContent = "â€¢â€¢â€¢â€¢â€¢";
  $("#btnReveal").disabled = false;

  // note
  $("#mNote").textContent = q.note ? q.note : "";

  // image
  if(q.img){
    $("#mImgWrap").classList.remove("hidden");
    $("#mImg").src = q.img;
  } else {
    $("#mImgWrap").classList.add("hidden");
    $("#mImg").removeAttribute("src");
  }

  // team pick hidden until "correct"
  $("#teamPick").style.display = "none";

  // timer
  clearInterval(timer);
  timeLeft = Number($("#qTime").value || 60);
  $("#mTimer").textContent = `â±ï¸ ${timeLeft}`;
  timer = setInterval(()=>{
    timeLeft--;
    $("#mTimer").textContent = `â±ï¸ ${timeLeft}`;
    if(timeLeft <= 0){
      clearInterval(timer);
      $("#mTimer").textContent = "â±ï¸ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª";
    }
  }, 1000);

  $("#overlay").style.display = "flex";
}

function closeModal(){
  clearInterval(timer);
  $("#overlay").style.display = "none";
  currentQ = null;
}

function addScore(team, points){
  if(team === "A"){
    teamA.score += points;
    $("#teamAScore").textContent = teamA.score;
  } else {
    teamB.score += points;
    $("#teamBScore").textContent = teamB.score;
  }
}

function exportBank(){
  $("#exportBox").value = JSON.stringify(BANK, null, 2);
}

function importBank(mode){
  const txt = $("#importBox").value.trim();
  if(!txt) return alert("Ø§Ù„ØµÙ‚ JSON Ø£ÙˆÙ„Ø§Ù‹.");

  let incoming;
  try{
    incoming = JSON.parse(txt);
  }catch(e){
    return alert("JSON ØºÙŠØ± ØµØ§Ù„Ø­.");
  }

  try{
    incoming = normalizeBank(incoming);
  }catch(e){
    return alert("Ø®Ø·Ø£ ÙÙŠ Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©: " + e.message);
  }

  if(mode === "replace"){
    BANK = incoming;
  } else {
    // merge by category id; Ø¥Ø°Ø§ id Ø¬Ø¯ÙŠØ¯ Ù†Ø¶ÙŠÙÙ‡
    const map = new Map(BANK.categories.map(c=>[c.id, c]));
    for(const cat of incoming.categories){
      if(!map.has(cat.id)){
        BANK.categories.push(cat);
        map.set(cat.id, cat);
      } else {
        // merge questions (no duplicate ids because normalizeBank made them unique globally)
        map.get(cat.id).questions.push(...cat.questions);
        // Ù„Ùˆ title ÙØ§Ø¶ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠØŒ Ø®Ø° Ù…Ù† Ø§Ù„Ø¬Ø¯ÙŠØ¯
        if(!map.get(cat.id).title && cat.title) map.get(cat.id).title = cat.title;
        if(!map.get(cat.id).thumb && cat.thumb) map.get(cat.id).thumb = cat.thumb;
      }
    }
  }

  // Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯: Ù„Ø§ Ù†Ù…Ø³Ø­ usedInGame Ø¥Ù„Ø§ Ø¥Ø°Ø§ Ø§Ù†Øª ØªØ³ÙˆÙŠ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©
  renderCategories();
  const st = bankStats();
  $("#bankStats").textContent = `Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª: ${st.cats} | Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©: ${st.qs} | Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©: ${usedInGame.size}`;
  alert("ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­ âœ…");
}

function clearAllQuestions(){
  if(!confirm("Ø£ÙƒÙŠØ¯ ØªØ¨ÙŠ ØªÙ…Ø³Ø­ ÙƒÙ„ Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©ØŸ")) return;
  BANK = { meta:{version:"empty"}, categories:[] };
  usedInGame.clear();
  updateUsedChip();
  renderCategories();
  $("#exportBox").value = "";
  $("#bankStats").textContent = "ØªÙ… Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©.";
}

/* =========================
   3) Events
   ========================= */
function wire(){
  $("#btnGoSettings").addEventListener("click", ()=>{
    $("#settingsSection").classList.remove("hidden");
    $("#gameSection").classList.add("hidden");
    setStatus("ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª");
    const st = bankStats();
    $("#bankStats").textContent = `Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª: ${st.cats} | Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©: ${st.qs} | Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©: ${usedInGame.size}`;
  });

  $("#btnSaveSettings").addEventListener("click", saveSettingsAndStart);

  $("#btnNewGame").addEventListener("click", ()=>{
    // Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø© = ØªØµÙÙŠØ± used + Ù†Ù‚Ø§Ø·
    usedInGame.clear();
    teamA.score = 0; teamB.score = 0;
    $("#teamAScore").textContent = 0;
    $("#teamBScore").textContent = 0;
    updateUsedChip();
    renderCategories();
    $("#valuesSection").classList.add("hidden");
    setStatus("Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©");
    // Ø§Ù†ØªÙ‚Ù„ Ù„Ù„ÙˆØ­Ø©
    $("#settingsSection").classList.add("hidden");
    $("#gameSection").classList.remove("hidden");
  });

  $("#btnResetUsed").addEventListener("click", ()=>{
    if(!confirm("Ù‡Ø°Ø§ Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø© ÙÙ‚Ø·. ØªØ¨ÙŠ ØªØµÙÙ‘Ø± Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±ØŸ")) return;
    usedInGame.clear();
    updateUsedChip();
    renderCategories();
    if(chosenCatId) selectCategory(chosenCatId);
  });

  $("#btnClose").addEventListener("click", closeModal);
  $("#btnNext").addEventListener("click", closeModal);

  $("#btnReveal").addEventListener("click", ()=>{
    if(!currentQ) return;
    $("#mA").textContent = currentQ.a;
    $("#btnReveal").disabled = true;
  });

  $("#btnCorrect").addEventListener("click", ()=>{
    if(!currentQ) return;
    // Ø¨Ø¹Ø¯ Ù…Ø§ ÙŠØ¶ØºØ· "ØµØ­ÙŠØ­" ØªØ¸Ù‡Ø± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ±ÙŠÙ‚
    $("#teamPick").style.display = "block";
  });

  $("#btnWrong").addEventListener("click", ()=>{
    // ØºÙ„Ø· = Ù„Ø§ Ù†Ù‚Ø§Ø·
    closeModal();
  });

  $("#pickA").addEventListener("click", ()=>{
    addScore("A", chosenValue);
    closeModal();
  });
  $("#pickB").addEventListener("click", ()=>{
    addScore("B", chosenValue);
    closeModal();
  });

  // manual scoring
  $("#teamAPlus").addEventListener("click", ()=> addScore("A", 100));
  $("#teamAMinus").addEventListener("click", ()=> addScore("A", -100));
  $("#teamBPlus").addEventListener("click", ()=> addScore("B", 100));
  $("#teamBMinus").addEventListener("click", ()=> addScore("B", -100));

  // bank management
  $("#btnExport").addEventListener("click", exportBank);
  $("#btnImport").addEventListener("click", ()=> importBank("merge"));
  $("#btnReplace").addEventListener("click", ()=> importBank("replace"));
  $("#btnClearAll").addEventListener("click", clearAllQuestions);

  $("#btnBackToBoard").addEventListener("click", ()=>{
    $("#settingsSection").classList.add("hidden");
    $("#gameSection").classList.remove("hidden");
    setStatus("Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©");
    window.scrollTo({top:0, behavior:"smooth"});
  });
  $("#btnScrollTop").addEventListener("click", ()=>{
    window.scrollTo({top:0, behavior:"smooth"});
  });

  // overlay click outside modal to close
  $("#overlay").addEventListener("click", (e)=>{
    if(e.target.id === "overlay") closeModal();
  });
}

/* =========================
   Boot
   ========================= */
loadInitial();
wire();
setStatus("ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª");
(() => {
  const st = bankStats();
  $("#bankStats").textContent = `Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª: ${st.cats} | Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©: ${st.qs} | Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©: ${usedInGame.size}`;
})();
</script>
</body>
</html>
